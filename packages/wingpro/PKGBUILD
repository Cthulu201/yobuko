# Maintainer: Cthulu201 <cthulu201@duck.com>

pkgname="wingpro"
pkgver=8.3.2.0
pkgrel=3
pkgdesc="Wing IDE Professional is the full-featured Python IDE for professional programmers."
arch=('x86_64')
url="http://www.wingware.com"
license=('custom')
groups=('yobuko')
depends=('python' 'libxcrypt-compat' 'xdg-utils' 'qt5-svg' 'libxcb' 'perl' 'java-runtime')
source=("https://wingware.com/pub/wingpro/${pkgver}/wingpro-${pkgver}-linux-x64.tar.bz2"
        "wingpro.install")
sha512sums=('7972060af66557d2d378e9f14a537ee9a8d1790c912ce8a41b6c8cb7f909b3406feb953fbec65aec3066d58dede8b063fd5c2c26f3cefa2c5cfabf4c2d2dca87'
            '003df3f0928ec119cade7cd04b6815fa01c2a41f764efce6d5ba143199da735da815892fa8c4dcb3a5ede27fc790caf7b74710563d84550b438b3a39fcdab310')
options=("!strip")

package() {
  cd "${srcdir}/${pkgname}-${pkgver}-linux-x64"
  ./wing-install.py \
  --install-binary \
  --winghome "${pkgdir}/opt/${pkgname}" \
  --bin-dir "${pkgdir}/usr/bin"
  
  sed -i "s|${pkgdir}||" "${pkgdir}/opt/${pkgname}/wingdbstub.py"
  sed -i "s|${pkgdir}||" "${pkgdir}/opt/${pkgname}/wing"
  sed -i "s,${pkgdir},,g" "${pkgdir}/opt/${pkgname}/file-list.txt"
  
  # Copy over patch (if any)
  if [ -d ../patches ]; then
      cp -r ../patches ${pkgdir}/opt/${pkgname}/.
  fi

  chmod +x ${pkgdir}/opt/${pkgname}/resources/linux/desktop/install-linux-desktop.sh
 
  # Install the LICENSE
  install -D -m 644 "${pkgdir}/opt/${pkgname}/LICENSE.txt" "${pkgdir}/usr/share/licenses/${pkgpname}/LICENSE"
}
